---
layout: "../../layouts/BlogPost.astro"
title: "Markdownでスライドを作成する方法"
description: "もっと扱いにくそう"
heroImage: "/lab/member/2109/images/beamer-themes.png"
pubDate: "2021/10/12"
---

## 導入
DS学部生に限らず、大学生はしばしばスライドによる発表を強いられる。私の場合、高校生の頃からスライド発表をやらされた経験があるので、スライドを作成した経験は多く、それで実際に発表をした経験もそれなりにある。

そんな私のプレゼンスキルは一旦置いておくとして、この記事ではスライド作成の方法についていろいろ考えて、最終的にMarkdownを用いてプレゼンするという提案をしたい。

## プレゼンの定番、Power Point

大学生の視点で考えてみる。先生に「では、最終発表の準備をしておいてください」といったようなことを言われた場合、私達はまず最初に何をする？

9割の人はデスクトップから**あのオレンジのアイコン**をダブルクリックして、Power Pointを起動するだろう。残りの1割はおそらくKeynoteを開いている。うちの学部でImpressを開く人はなかなかいないだろう。まあ、ここではPower Pointに限った話をするのだが、このアプリケーションは幾つかの問題点 (不満点) を抱えている。

だが平和を保つために、まずは個人的に思うPower Pointの良い点を考えてみよう。

### Power Pointはわかりやすい

Power Pointは何よりも**わかりやすい**というのが最大の利点だろう。実際にどのように表示されるのかすぐに分かり、それを見ながら実際に編集していくことができる。このような編集方法をWYSIWYG (What You See Is What You Get)などと呼んだりするが、最も広く普及している文書作成方法がこれになるだろう。

わかりやすいこと以外だと、文書の自由度が高いことだろうか。これは非論理的な文書を乱造できることと表裏一体なのだが、イレギュラーな文書を作成したいケースはないこともないので、利点と呼んでもよいだろう。

ではここから、気に入らないところを書き出してみよう。

### 問題点(1): 実用性皆無な謎機能の数々

Power Pointではスライドを鮮やかにするためのデフォルトのテーマがbuiltinで大量に用意されている。これらのすべてを私は試したことがないし試せる気もしない。Wordのときもそうだが、余所に提出するドキュメントはとにかく色鮮やかで派手でないといけないのだと、MS Officeの開発チームは考えているのだろうかと思えるほどに、テーマの種類が多い。

まあ、たしかに見た目の派手さは無駄とは言い切らないが、それにしてもPower Pointのテーマは**どれも実用性がなさすぎる**。例えば、「配色」という名前のテーマを選択してみる。すると驚くべきことに、フォントサイズが蟻ん子みたいに小さくなってしまうではないか！　なるほど、近眼お断りというわけか。

![春学期最後のニュース発表のときのスライド](/lab/member/2109/images/pptslide-before.png)

![テーマを変更すると突然フォントが小さくなる](/lab/member/2109/images/pptslide-after.png)

もちろん、フォントが小さいのなら大きくするように調節すればよいのだが、builtinのテーマでそのような大胆な調整を必要とするのか？　テーマを変更する前の真っ白な状態だとフォントを大きくする必要がないのだから、何をしているのかよくわからなくなってくる。おそらくフォントサイズが小さくなっているというより、フォントがそもそもサイズが小さくデザインされているような気がする。だがそんなことはどうでもよい。とりあえず、この読ませる気のないフォントサイズを早急にどうにかしてくれ。

また、Power Pointではスライドの切り替えで「渦巻き」というアニメーションを適用することができる。これを用いると、スライドが切り替わるときに、表示されていたスライドが霧状に拡散し、次のスライドの形に再構成されるという、派手な演出が発生する。

![少年ジャンプにこういうキャラいそう](/lab/member/2109/images/pptslide-uselessanime.gif)

当然、こんなの使わないし、ここまでグラフィック処理を強制されるようなアニメーションをプロジェクターやZoomの画面共有で再生できるとは思えない。ただでさえ一般人のPCのスペックは抑えめにされているのに、ZoomやTeamsによって圧迫されたPCのリソースをこの余計なアニメーション処理でさらに消費させようというわけだ。

さすがにこの切り替えアニメーションは無用すぎるが、それにしてもアニメーション切り替えに必要以上のアニメーションが利用可能になっている理由がわからない。誰にも使われない機能だろうし、プレゼンテーションをする際に余計なことをしようとする学生や初心者が増える要因にもなりうる気がする。

### 問題点(2): フォーマッティングが面倒、論理構造が意味不明

1つ目の問題点はあくまで機能追加の方向性が意味不明なだけであって、別に使わなければ問題ない。ライセンス料も、別に私が払っているわけでなく学費や税金から捻出されているので、ある程度は仕方ない。もし私がライセンス料を払ってこれを使わされているとしたら、すぐに使うのを辞めるしそもそも使わないだろうけど。

しかし、もしスライド中に数式を表示したいと思ったら、なんとあの打ちにくい数式入力用のUIでなんとか整形するしかない。数式の入力にはLatexが圧倒的に早いのは周知されているとおりだろう。一度覚えてしまえば、いくらでも入力を早くできるLatexでの入力にはある程度は対応しているの (例えば、`\alpha`と入力すると自動でギリシア文字のアルファに変換されるなど) だが、すべてが必ずそうではない。しかも数式入力モードに入るのに、Wordならショートカットキーが割り当てられていてまだ救いようがあるが、Power Pointではなぜかそれがない。いちいち「挿入」タブに切り替えて、「数式」をクリックしなければならない。キーボードからマウスに手を動かし、挿入タブをクリックし、さらに数式ボタンをクリックするということで、必要なステップが変に増えてしまう。

ソースコードを挿入したいと思ったら、どうなるだろう。先生によってはもうプロポーショナルフォントのままソースコードを記述している。そのため単なるコピペでは動かないソースが学生に公開され混乱を呼んでいるのだが、これをちゃんと編集しようと思ったら、自分で等幅フォントを指定して、手動でフォーマットする必要がある。いやあなんということだ、さすがにverbatimモードくらい搭載しておいてほしかったが。

そもそも太字、斜体などの指定のためにキーボードからマウスに手を動かし、どういう条件で表示されるのかわからないインライン修飾メニューを選択しなければならない。インライン修飾メニューが表示されたらそれを操作すればある程度楽になるのだが、それが表示されなくなることがある。そうなると、「ホーム」タブを開いて小さいボタンを押す必要があり、これもまた面倒だ。

リンクをはろうとすれば「挿入」タブをわざわざクリックしなければならず、やはり面倒だ。表の挿入なんてもっと大変だ。一度「表」をクリックして、さらに表のサイズを指定する必要がある。表に列を追加したければ、またしても表のレイアウトを設定する専用のタブを開いて、ボタンを何度かカチカチしなければならない。

プログラマとしては、作成する文書に論理的な構造が規定されていないと気持ち悪さを覚えるだろう。誰かが作成したスライドを開いたとき、そこにはスライドテンプレートも、フォントの統一も何も存在せず、マウス操作で思いのままに作成したスライドがずらりと並べられていたときの違和感と言ったら、凄まじいものだ。Power　PointのWYSIWYGな操作方法は、一見自由で操作しやすいと感じるかもしれないが、再現性のないGUIをユーザーに強いることで、生産性の薄いスライドを量産させることに寄与してしまう場合がある。

### 問題点(3): Vimでないテキスト編集

これ言っちゃったらおしまいだろ。まあ、仕方ない。方向キーやマウスがホームポジションから遠すぎる。

### まとめ

とまあ、こんな感じでPower Pointの不満点を述べていったが、結局は以下の二点に集約されるだろう。

* デフォルトテーマなどのデザインに実用性がない
* インライン修飾、数式やソースコードの挿入が面倒

その他、10年前のPower Pointで同じファイルを開いたら数式が表示されないとか、UIが年々全く違うものになっていて操作方法を覚え直さないといけないとかいろいろ不満点はあるかもしれない。LaTeXの拡張としてLuaTeXやらXeLaTeXやら大量に登場しているLaTeX界隈も人のことを言えたものじゃないので、これは仕方ない気がしてくる。

そんなPower Pointを用いたスライド作成に辟易してしまった皆さんに、ようやく本題のMarkdownによるスライド作成方法の提案を行いたい。

## 基本的な作成法

Markdownでスライドを作成なんて、一体どうやるんだと思われるだろう。大まかな流れを説明しよう。

基本的に次のようなソフトウェアを用いる。

* LaTeX + Beamer
* Pandoc
* テキストエディタ

### Markdownとはなにか

Markdownについてそもそも知らないという人はあまりいないかもしれないが、これはドキュメントを記述するのにしばしば使われる軽量のマークアップ言語である。このブログ記事もMarkdownで執筆されたものをHTML形式に変換して公開している。記述が楽だがデザインの自由度は低いとされており、使い所は限られる。だがちょっとしたメモ程度なら非常に向いているし、凝ったレイアウトにしたくなければたいていこのMarkdown形式で事足りる。

Markdownはプレインテキストで編集可能かつ、HTMLやPDFに変換しなくても、記述されたままでも十分に視認性の高いマークアップ言語としてもともと提案された。詳細はQiita記事の書き方とか、その他様々なチートシートを参照してもらおうと思う。

Markdownには方言が幾つもあり、これと決まった仕様が存在するわけではない。このお手軽さも賛否両論なのだが私は全然問題ないと思っている。今の所統一した規格を定めることで得られる利点があるようには思えない。

### LaTeX

LaTeXはTeXという組版システムをもとに構築された文書処理システムである。理系の学生はたいてい知っていると思うので、これも詳細は[ここ](https://texwiki.texjp.org/?%E3%81%AF%E3%81%98%E3%82%81%E3%81%A6%E3%81%AE%E6%96%B9%E3%81%B8)を見てほしいのだが、要するに命令ベースで文書の作成を行えるのである。発想法としてはHTMLに近いのだが、HTMLはウェブページの記述に使われるのに対し、LaTeXは実際に出版される書籍や、学術論文の執筆などにも使われる。

昨今のMarkdownの機能拡張はHTMLかあるいはLaTeXに依存してしまっている。やはり相変わらずMarkdownの表現力の貧弱さに起因するものだが、私は問題になるとは思わない。この複雑で難解な部分をあえて覆い隠して、なおかつ作業の効率性を失わせずに手軽に文書を作成できるのだから、Markdownにも一定の利用価値があると思われる。

ともあれ、今後の作業を進めていく中でLaTeXの知識が一切ないという状態だと、いろいろな場面で支障をきたすので、適宜LaTeXの概要や、ざっくりとした使い方を知っておくことをおすすめする。

### Beamer

LaTeXでは最終的にPDFファイルによる文書が完成するのだが、文書でなくスライドショーを作成することもできる。LaTeXでスライドを作成することができるパッケージこそがこのBeamerである。LaTeX使いの中でスライドショーも作成しなければならないとき、おそらく大多数がBeamerを利用している。

### Pandoc

今回の記事のかなめとなるソフトウェアである。Haskellで開発された文書変換ソフトであり、怠惰な私達がLaTeXをまともに勉強せず手を抜いてMarkdownで拵えた粗末な原稿を、LaTeX/Beamer形式のソースコードに変換して、最終的にPDFファイルに変えてくれる。基本的な使い方は[Pandoc User's Guide](https://pandoc.org/MANUAL.html)を見てくれればよいが、何も知らない状態でこの長大な説明書をいきなり一読するのは大変だ。必要最低限の使い方だけ、この記事で説明したい。なにしろ私も、Pandocの機能をまったく把握できていないのだから。

### 手順

さて必要なキーワードについて見ていったところで、これらを使って具体的にどのように作成するのだろうか。

1. Markdown形式で原稿を書く
2. Pandocを用いてMarkdownの原稿をLaTeX/Beamer、そしてPDFに変換する。

以上の2ステップでスライド作成は完了する。作業量自体は多くないが、知っておくべき内容が多いかもしれないので、わからないところは適宜Pandoc's User Guideを参照するか、適当にググるかしなければならない。

## 環境の整備

とりあえずWindows環境を想定する。別にMacやLinuxになったところで、インストール方法を調べる手間が増えるだけなので、些細な問題だろう。

### TexLive

LaTeX環境の構築にはいくつかやり方がある。その中で最も王道かつ確実なのがおそらくTeXLiveでないだろうか。

TeXLiveはLaTeXのディストリビューションの一つであり、おそらくいちばんよく見かけるLaTeXである。他にもMiKTeXとかあるが、ブログ記事などを漁っていてもそこまで仕様車を見ないので、あまりきにせずTeXLiveをインストールすれば良い。

まず[このページ](https://texwiki.texjp.org/?TeX%20Live%2FWindows)を参照しながら、TeXLiveが配布されているページに飛ぶ。あとは画面の手順に従って、`install-tl-windows-.bat`バッチファイルを実行する。GUIによるインストーラが起動したら、"Next"やら"Install"やらをクリックしながら、インストールが完了するのを待とう。結構時間がかかる。

インストールが完了すると、「TeX Liveへようこそ！」などと表示される。LaTeXでスライドを作成するためにはBeamerも入手する必要がかつてはあったが、現在はTeXLiveにはじめから含まれているので、改めてインストールする必要はない。

### Pandoc

次に、Pandocのインストールを行う。

こちらも[このページ](https://pandoc.org/installing.html)からインストーラを入手することができる。画面の支持に従ってインストールを行おう。

Chocolateyというパッケージマネージャを使ってインストールすることもできる。その場合は次のコマンドを使えば良い。

```
choco install pandoc
```

### テキストエディタ

このセクションは任意になる。なぜなら、スライド作成のために改めてテキストエディタをインストールする必要はなく、これまでに使ってきたエディタをスライド作成においても使用すればよいからだ。スライド作成やMarkdown編集におすすめのエディタなどない (どれを使っても同じだろう) 。

ちなみにVimではPandocのコマンドをVimから実行できるプラグインが利用可能だ。

* [vim-pandoc/vim-pandoc](https://github.com/vim-pandoc/vim-pandoc)
* [vim-pandoc/vim-pandoc-syntax](https://github.com/vim-pandoc/vim-pandoc-syntax)

ちなみに私はこれを使っていない。一時期入れていたが、別にコマンド入力を手元ですればよいかと思い、環境から削除した。シンタックスハイライティングは便利でおすすめではあるので、使ってみたい人は是非導入してみてほしい。

## いよいよ執筆

### はじめてのスライド

セットアップが完了したらようやくスライドを作成することができる。各々が愛用しているテキストエディタを立ち上げて、次のようなサンプルスライドを作成してみよう。

```markdown
% My First Presentation
% Your Name
% 2021/12/31

# What is Markdown?
* Light, simple and easy to write
* Even readable on plain text
* Convertible into many kinds of documents with Pandoc
```

わずか8行程度の文章だが、これでもスライドになる。このテキストファイルを`sample.md`として保存し、ターミナルを立ち上げて、次のように入力する。

```
pandoc -f markdown -t beamer --pdf-engine xelatex -o sample.pdf sample.md
```

`sample.pdf`を開くと、このようなタイトルスライドをもつ2ページのスライドショーが完成する。

![](/lab/member/2109/images/sample-title.png)

### 基本構成

最初の部分では、メタデータを記述する。%から始まる3行で、それぞれスライドのタイトル、発表者の名前、日付を記述する。メタデータはこのようにYAML形式でより詳細に記述することもできる。YAMLブロックは`---`で囲まなければならない。

```yaml
---
title: "My First Presentation"
author: "Your Name"
date: "2021/12/31"
---
```

YAMLメタデータブロックには、他にも次のような設定を追加できる。

* `aspectratio` : スライドのアスペクト比を設定する。既定では34だが、169なども設
  定できる。
* `subtitle` : スライドのタイトルページに副題を付ける。
* `fontsize` : スライドのフォントサイズを設定する。Beamerでは8pt, 9pt, 10pt,
  11pt, 12pt, 14pt, 17pt, 20ptが指定可能。
* `mainfont` : スライドのメインのフォントを設定する。日本語と英語を両方使用する
  ときはこれだとちょっと不便。
* `theme`, `colortheme`, `fonttheme`, `innertheme`, `outertheme`: Beamerの
  builtinの**実用的な**テーマを選択する。Beamerにはいくつかのテーマを選択でき、
  おすすめはMadrid, Copenhagenなど。ただどれも似通っており、違いがよくわからな
  い。
* `logo` : 各スライドにロゴ画像をつける。
* `titlegraphic` : タイトルスライドに画像をつける。

### スライドの構造を決定する

Markdownでは`#`から始まる行が「見出し」と呼ばれる。HTMLの`<h1>`などに相当する。既定では、見出し以外の何らかのスライドコンテンツ (段落、箇条書き、表など) が直
後に現れる見出しの中で、最も高い見出しレベルが、「スライドレベル」として設定さ
れる。

例えば次のようにスライドを作成したとする。 (本文はPandoc User's Guideから引用)

```markdown
% Habits
% John Doe
% March 22, 2005

# In the morning

## Getting up

- Turn off alarm
- Get out of bed

## Breakfast

- Eat eggs
- Drink coffee

# In the evening

## Dinner

- Eat spaghetti
- Drink wine

------------------

![picture of spaghetti](images/spaghetti.jpg)

## Going to sleep

- Get in bed
- Count sheep
```

このとき、スライドレベルは2に設定される。なぜなら、レベル1の見出しの直後には必ず見出しが続いているからである。このときレベル1の見出しはスライドのセクションと解釈され、Beamerスライドを作成する際に、自動的に見出しのみを含むタイトルスライドを作成する。

水平線 (`-----`など) は強制的に改ページする。画像だけを表示したい場合などに使われるのだろう。

### 本文を記述する

スライドの構造を決定したら、スライドに書く文章の書き方を見ていく。基本的には一般的なMarkdownの記法を思い出せば良い。

#### インライン修飾
\*\* で囲むと太字になり、\*で囲むと斜体になる。

```markdown
**Bold**
*Italic*
```

\~\~で囲むと取り消し線になる。\[\]\{\}のによるspan構文で、下線になる。

```markdown
~~srtrikethough~~
[underline]{.underline}
```

#### 表

いくつかやりかたがある。

最もシンプルなのは、このようにハイフン`-`のみを用いて表を作成するというもの。

```markdown

   Pref.      City
-------- ----------
  Shiga        Otsu
Fukuoka      Hakata

```

これは等幅フォントで表組みをする必要がある。

パイプ`|`も一緒に使うとこうなる。

```markdown

+---------+-----------+
|    Pref.|       City|
+=========+===========+
|    Shiga|       Otsu|
+---------+-----------+
|  Fukuoka|     Hakata|
+---------+-----------+
```

こちらのほうが作るのが大変になる。見栄えは良くなるが、私はあまり好きでない。

パイプのみを使って作成することもできる。

```markdown

   Pref.|   City
--------|--------
   Shiga|   Otsu
 Fukuoka| Hakata

```

私はパイプを使う方法が好きで、Markdown原稿を見ると、表はたいていパイプテーブルで表現されている。一度は[Pandoc User's Guideの「表」の部分](https://pandoc-doc-ja.readthedocs.io/ja/latest/users-guide.html#tables)を参照しておくのをおすすめする。

#### リスト

リストの作成も、よくあるMarkdownの記法と変わらない。`*`, `-`, `+`のいずれかで行を始めればリストを作成できる。

```markdown
- Shiga
    * Otsu
    * Hikone
        + Shiga Univ
    * Kusatsu
- Kyoto
    * Kyoto
    * Uji
    * Kyotanabe
```

順序付きリストは、`1.`, `2.`のように行頭に書く。

```markdown
1. First
2. Second
3. Third
```

実は連番は自動的に作成される。

```
1. First
1. Second
1. Third
```

#### リンク、画像

リンクは次のような構文を使う。角カッコのなかに表示するテキスト、続く丸括弧の中にリンク先を書く。

```markdown
If you want more information, [click here](https://www.google.com)
```

画像も実は似たような方法で表示できる。リンクの構文に`!`をつけただけである。角カッコの中は代替テキストとキャプションになる。

```markdown
![My Portrait](/lab/member/2109/images/snapshot.jpg)
```

#### レイアウト

`:`を3つ以上続けて、HTMLの`<div>`のようなものを作成できる。これを利用して、スライドを縦に分割できる。

```markdown

:::::::::::::::::::::{.columns}
::: {.column width="40%"}
contents...
:::

::: {.column width="60%"}
contents...
:::
:::::::::::::::::::::
```

左側に画像、右側に説明など、より見やすいレイアウトを設定することができる。

### 文書を変換する

スライドが完成したら、`pandoc`コマンドを使ってMarkdown文書をPDFに変換する。基本的に次のコマンドで完了する。

```
pandoc -f markdown -t beamer -o slide.pdf slide.md
```

`-f`はファイルの変換元、`-t`はファイルの変換先を指定する。今回はそれぞれ`markdown`と`beamer`で固定になる。

`-o`は出力するファイル名である。拡張子は`.pdf`にする。

あとは、作成したMarkdownファイルを指定して、しばらく待てば変換する。

ただし、もしスライドに日本語の文字を設定している場合、デフォルトの設定だとエラーが発生してうまく行かないので、pdfの生成エンジンとして、`xelatex`などを指定するように設定しておくことをおすすめする。

```
pandoc -f markdown -t beamer -o slide.pdf slide.md --pdf-engine xelatex
```

## 見栄えを良くする

Beamerではより実用的かつ見栄えの良いテーマを使用することができる。問題点は、実用性を重視しすぎてデザインがどれも同じに見えてしまうことだが、それは些細な問題だろう。もし余裕があれば、インターネットで検索してBeamer用のテーマを探してくるか、あるいは自分でテーマを作れば良い。

### テーマを設定する。

[このページ](https://hartwork.org/beamer-theme-matrix/)から、Beamerで使用可能なテーマとカラーテーマの組み合わせを一覧することができる。テーマが都市名、カラーテーマが動植物名という命名規則になっているようだ。

![読み込みに結構時間がかかる](/lab/member/2109/images/beamer-themes.png)

私はWarsaw+seahorseやMadrid+defaultあたりをよく使っている。「選んではいけない」ものは特にないので好きに選べば良いと思う。

これを適用するには幾つかやり方があるが、YAMLメタデータブロックに記述するのがおすすめである。

```yaml
---
title: "Presentation Title"
author: "John Doe"
date: 2021/12/31
theme: "Warsaw"
colortheme: "seahorse"
---
```

いくつかのテーマを同時に試したい場合、コマンド入力時に`-V`オプションで設定することもできる。

```
pandoc -f markdown -t beamer --pdf-engine xelatex -o slide01.pdf slide.md -V theme=Warsaw -V colortheme=seahorse
pandoc -f markdown -t beamer --pdf-engine xelatex -o slide02.pdf slide.md -V theme=Madrid
```

### 欧文フォントと和文フォントを設定する

デフォルトだとラテン文字しかスライドに使用することができない。日本語を表示するためには、日本語の文字を表示できるフォントファミリを設定する必要がある。いくつかやり方があるが最もシンプルなのは、YAMLメタデータブロックで`mainfont`, `CJKmainfont`を設定することだろう。

```yaml
title: 私の最初のプレゼン
author: ぷれぜん太郎
date: 2021/12/31
mainfont: Yu Gothic
```


```yaml
title: 私の最初のプレゼン
author: ぷれぜん太郎
date: 2021/12/31
mainfont: "Lucida Sans"
CJKmainfont: "Yu Gothic UI"
```

こうすると、ラテン文字に対してLucida Sansを適用し、日本語に対しては游ゴシックを指定することができる。

## まとめ

このようにするとあの重たくてごちゃごちゃしたPower Pointの画面に向かってマウスポインタを縦横無尽に動かす必要がなくなる。私たちは比較的シンプルなUIを有するテキストエディタのみを開き、原稿の執筆に集中することができるのである。

まとめるとこうなる。

* Power Pointを使うのをやめよう
    * 謎機能を乱用しなければ悪くないと思うが……
* Markdownの構文を使ってスライドを作成できる
    * ここでは説明しなかったが、数式やソースコードの埋め込みも論理的な方法で行
      える。
* Pandoc, TeX Liveをインストールする必要がある。
    * 無料だがセットアップが面倒
    * 必要になる知識も多い。

それでは良いプレゼンライフを。
